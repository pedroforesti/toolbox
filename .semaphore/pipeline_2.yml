version: v1.0
name: Initial Pipeline
agent:
  machine:
    type: f1-standard-2
    os_image: ubuntu2204
blocks:
  - name: 'Block #1'
    task:
      jobs:
        - name: 'Job #1'
          commands:
            - checkout
            - sleep $((10 + $RANDOM % 40))
            - 'export SUPERPLANE_URL=https://superplane.sxmoon.com'
            - 'curl "$SUPERPLANE_URL/api/v1/outputs" -X POST -H "Content-Type: application/json" -H "Authorization: Bearer $SEMAPHORE_OIDC_TOKEN" --data "{\"execution_id\": \"$SUPERPLANE_STAGE_EXECUTION_ID\",\"external_id\": \"$SEMAPHORE_WORKFLOW_ID\",\"outputs\": {\"spc_tag\":\"$spc_tag\",\"artifact_tag\":\"$artifact_tag\",\"when_tag\":\"$when_tag\",\"toolbox_tag\":\"$toolbox_tag\"}}"'
